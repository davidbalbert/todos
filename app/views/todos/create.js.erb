<% if @todo.valid? %>
    <% if @list.todos.count == 1 %>
        $("#todos-container").
        replaceWith("<%=j render partial: 'todos_container',
                    locals: {list: @list}%>");
    <% else %>
        $("#todos").append("<%=j render partial: 'todo',
            locals: {todo: @todo, list: @list}%>");
    <% end %>

    $("#list-header").
        replaceWith("<%=j render partial: 'lists/header',
        locals: {list: @list}%>");

<% end %>

$("form#new_todo").replaceWith("<%=j render partial: 'form',
    locals: {list: @list, todo: @new_todo}%>");
